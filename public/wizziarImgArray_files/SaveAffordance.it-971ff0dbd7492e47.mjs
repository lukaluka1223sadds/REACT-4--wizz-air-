"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[47442],{792862:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var a=n(667294),i=n(545007),o=n(883119),l=n(161759),r=n(985459),s=n(547504),c=n(95460),d=n(382248),u=n(233846),_=n(967312),p=n(298568);function v({constraint:e}){let t=(0,p.E)(),n=t?.getId();return(0,a.useEffect)(()=>{t&&t.markConstraintComplete(e)},[n,e]),null}var h=n(349057),m=n(181710),b=n(943369),S=n(677316),f=n(755090),k=n(882368),g=n(604342),A=n(356204),x=n(739951),y=n(506536),C=n(757653),I=n(785893);let w=(0,C.Z)(()=>n.e(43473).then(n.bind(n,16736)),void 0,e=>16736,"PinSaveButtonCommon"),P=(0,a.lazy)(async()=>({default:(await Promise.all([n.e(69965),n.e(22538)]).then(n.bind(n,797043))).QuickSaveButtonWithExperienceAnchor})),Z=({boardCount:e=0,clientTrackingParams:t,fromEggsBoard:n,onBoardSelectionFlyoutChange:C,onClickCallback:Z,pin:B,showEnabledSaveBehavior:E,showRepinOnInitialRender:j,variant:D,viewParameter:T,viewType:M})=>{let O=(0,p.E)(),{experience:Q}=(0,d.Ow)(1000310),{checkExperiment:L}=(0,_.F)(),{experience:K}=(0,d.Ow)(12),N=(0,S.Z)(),R=(0,i.I0)(),F=(0,u.ZP)(),U=(0,k.Z)(),z=(0,a.useRef)(!1),{pins:H,clear:W}=(0,A.Z)(),q=(0,b.M0)().getItem(s.M8)||"",V=q?q===B.id:!!H&&H.length>0&&H[H.length-1].id===B.id;(0,f.Z)(()=>{z.current||2!==H.length&&(1!==H.length||V)||(z.current=!0,(2===H.length&&!q&&V?[H[0]]:H).forEach(({id:e,nodeId:t})=>{(0,r.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},F).then(n=>{let{id:a,url:i,name:o}=n;R((0,x.d)({boardId:a,url:i,title:o||"",pinId:e||"",nodeId:t}))})}),V||W())});let X=U.isAuth&&L("web_curation_brv_navigate_to_board_from_closeup").anyEnabled,$=()=>{(0,b.M0)().removeItem(s.M8),W(),N({action:"trigger",item:"unauth-save-button-quicksave"}),R((0,y.Z)(!0)),R((0,x.d)({boardId:"",url:"",title:"Profile",pinId:B.id,nodeId:B?.node_id})),R((0,x.X)(B))},G=()=>{(0,h.Nx)("button"),O&&O.markConstraintComplete("button")};if(B?.pinner?.blocked_by_me||B?.promoted_is_removable)return(0,h.Nx)("button"),(0,I.jsx)(v,{constraint:"button"});if(Q&&502450===Q.experience_id)return(0,I.jsx)(c.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,I.jsx)(m.Z,{children:(0,I.jsx)(P,{autoQuicksaveCallback:$,clientTrackingParams:t,experience:Q,onClickCallback:Z,onMount:G,pinKey:{type:"deprecated",data:B},shouldAutoQuicksave:V,showEnabledSaveBehavior:E,viewParameter:T})})});let J=!B.content_sensitivity?.is_sensitive_content&&void 0!==e,Y=[501041],ee=K&&501041===K.experience_id&&K.display_data.has_tooltip?e=>(0,I.jsx)(d.Qp,{anchor:e,experienceIds:Y,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):e=>(0,I.jsx)(d.N,{anchors:{3010:e},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0});return J?(0,I.jsx)(o.xu,{children:(0,I.jsx)(c.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,I.jsx)(g.default,{autoQuicksaveCallback:$,clientTrackingParams:t,fromEggsBoard:n,onClickCallback:Z,onMount:G,onToggleFlyout:C,pinKey:{type:"deprecated",data:B},renderPinSaveTooltip:ee,renderSavedStatus:X?({savedInfo:e,showBoardFlyout:t,handleBoardDropdownClick:n})=>(0,I.jsx)(l.Z,{accessibilityLabel:F.bt("Seleziona una bacheca in cui salvarlo", "Select a board you want to save to", "Closeup.BoardSelection.SplitSaveButton", undefined, true),isSaved:!0,onClick:n,selectedItem:e,showBoardFlyout:t}):void 0,shouldAutoQuicksave:V,variant:D,viewParameter:T,viewType:M})})}):(0,I.jsx)(c.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,I.jsx)(m.Z,{children:(0,I.jsx)(w,{clientTrackingParams:t,isCloseupPin:!0,onClickCallback:Z,onMount:G,pinKey:{type:"deprecated",data:B},renderPinSaveTooltip:ee,showRepinOnInitialRender:j})})})}},356204:(e,t,n)=>{n.d(t,{$:()=>s,Z:()=>u});var a=n(547504),i=n(838380),o=n(967312),l=n(943369),r=n(756493);let s=2,c=e=>e?.pins??[],d=e=>e.length?{pins:e}:null,u=()=>{let e=(0,l.M0)(),t=c(e.accessAllowed?e.getItem(a.s1):r.ZP.getItem(i.w3)),n=t=>e.accessAllowed?e.setItem(a.s1,d(t)):r.ZP.setItem(i.w3,d(t)),u=s,{checkExperiment:_}=(0,o.F)(),p=()=>{let e=_("mweb_block_unauth_save").group;if(e.startsWith("enabled")){let[,t]=e.split("_");u=Number(t)}return t.length<u};return{pins:t,save:e=>{p()&&n(t.filter(({id:t})=>t!==e.id).concat([e]))},unsave:e=>n(t.filter(({id:t})=>t!==e)),isSaved:e=>t.some(({id:t})=>t===e),clear:()=>n([]),canSaveMore:p}}},506536:(e,t,n)=>{n.d(t,{Z:()=>a});function a(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/SaveAffordance.it-971ff0dbd7492e47.mjs.map